

-----------------------------------------------

http://mrg.doc.ic.ac.uk/publications/structuring-communication-with-session-types/main.pdf
pg 14 fig 6

protocol RequestResponse(role Client as cl, role Server as sr) {
    choice at cl {
        GET() from cl to sr;
        choice at sr {
            sc200(s:String) from sr to cl;
        } or {
            sc500(reason:String) from sr to cl;
            ...
        } or {
            POST() from cl to sr;
            ...
            ...
        }
    }
}

testing for optimisation get interpretation as all true, but did not implment this
(this function always returns a true)
the point is not to test for tautology so shouldnt have a result that returns so

def checkString(s : String) : Boolean = {
    var s_temp = s
    while (s_temp.trim().nonEmpty){
      s_temp = s_temp.dropRight(1)
    }
    s_temp.trim().isEmpty
  }



Term.If(
    Term.Name("check"),
    Term.Assign(Term.Name("i"), Lit.Int(1)),
    Term.Assign(Term.Name("i"), Lit.Int(2))
)

Term.If(
    Term.ApplyInfix(Term.Name("check"), Term.Name("=="), Nil, List(Lit.Int(1))),
    Term.Assign(Term.Name("i"), Lit.Int(1)),
    Term.If(
        Term.ApplyInfix(Term.Name("check"), Term.Name("=="), Nil, List(Lit.Int(2))),
        Term.Assign(Term.Name("i"), Lit.Int(2)),
        Term.Assign(Term.Name("i"), Lit.Int(3))
    )
)